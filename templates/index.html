{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h1 class="mt-5">Welcome to Tube2Spotify!</h1>
    <p>Ready to export your YouTube playlist to CSV or transfer it directly to Spotify?</p>

    <div class="row">
        <!-- Option to export to CSV -->
        <div class="col-md-6 mb-4">
            <h2><i class="fa fa-download"></i> Export to CSV</h2>
            <p>Get a CSV file of your YouTube playlist for easy use on other platforms.</p>
            <div class="instructions">
                <h5>How to find your YouTube API Key:</h5>
                <p>1. Go to the <a href="https://console.developers.google.com/" target="_blank">Google Developers Console</a>.</p>
                <p>2. Create a new project and enable the YouTube Data v3 API.</p>
                <p>3. Go to "Credentials" and click "Create Credentials" then "API Key".</p>
                <p>4. Copy the generated API Key and paste it below.</p>
            </div>
            <form action="/export_csv" method="POST" onsubmit="showLoaderCSV()">
                <input type="text" name="youtube_api_key" class="custom-input" placeholder="Enter your YouTube API Key" required>
                <input type="text" name="playlist_id" class="custom-input" placeholder="Enter the Playlist ID" required>
                <button type="submit" class="btn btn-primary">Export Playlist to CSV</button>
            </form>

            <!-- Progress bar for CSV export -->
            <div class="progress" style="height: 25px; margin-top: 20px;">
                <div id="progress-bar-csv" class="progress-bar progress-bar-striped progress-bar-animated bg-primary" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
            </div>

            <!-- Loading message for CSV export -->
            <div id="loading-message-csv" style="text-align: center; margin-top: 20px; display: none;">
                <p>Exporting in progress, please do not close this page...</p>
            </div>
        </div>

        <!-- Option to import directly to Spotify -->
        <div class="col-md-6 mb-4">
            <h2>
                <!-- Spotify SVG Logo in Green -->
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="30" height="30" viewBox="0 0 256 256" xml:space="preserve" style="vertical-align: middle; margin-right: 10px;">
                    <defs></defs>
                    <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                        <path d="M 44.999 0.002 L 45 0 C 20.148 0 0 20.147 0 44.999 C 0 69.854 20.148 90 45 90 c 24.853 0 45 -20.146 45 -45.001 C 90 20.149 69.854 0.002 44.999 0.002 z M 65.637 64.902 l -0.001 0.001 C 65.636 64.902 65.636 64.902 65.637 64.902 c -0.808 1.326 -2.535 1.741 -3.857 0.933 c -10.567 -6.458 -23.868 -7.917 -39.532 -4.339 c -1.509 0.346 -3.014 -0.6 -3.358 -2.109 c -0.346 -1.509 0.596 -3.014 2.11 -3.358 c 17.142 -3.919 31.845 -2.232 43.706 5.016 C 66.028 61.856 66.447 63.58 65.637 64.902 C 65.637 64.902 65.637 64.902 65.637 64.902 z M 71.144 52.651 C 71.144 52.651 71.144 52.651 71.144 52.651 L 71.144 52.651 L 71.144 52.651 c -1.018 1.651 -3.177 2.169 -4.826 1.155 c -12.093 -7.434 -30.534 -9.587 -44.841 -5.244 c -1.855 0.56 -3.815 -0.485 -4.378 -2.338 c -0.559 -1.855 0.487 -3.811 2.34 -4.376 c 16.343 -4.959 36.659 -2.557 50.55 5.979 C 71.638 48.843 72.16 51.004 71.144 52.651 L 71.144 52.651 z M 71.618 39.892 L 71.618 39.892 c -14.506 -8.614 -38.432 -9.406 -52.279 -5.204 c -2.224 0.674 -4.575 -0.581 -5.249 -2.804 c -0.674 -2.225 0.58 -4.575 2.805 -5.25 c 15.896 -4.825 42.32 -3.893 59.018 6.019 c 2 1.187 2.656 3.77 1.471 5.767 C 76.201 40.42 73.611 41.079 71.618 39.892 z" style="fill: rgb(29, 185, 84);" transform="matrix(1 0 0 1 0 0)" stroke-linecap="round"></path>
                    </g>
                </svg>
                Import to Spotify
            </h2>
            <p>Transfer your YouTube playlist directly into a Spotify playlist with Tube2Spotify.
            </p>
            <p> Transfer time to spotify depends on the size of your playlist: less than 20 seconds for 100 tracks, but around 10 minutes for 4000 tracks, with a success rate of around 95%. </p>
            <div class="instructions">
                <h5>How to find your Spotify Credentials:</h5>
                <p>1. Go to the <a href="https://developer.spotify.com/dashboard/applications" target="_blank">Spotify Developer Dashboard</a>.</p>
                <p>2. Log in and create a new application.</p>
                <p>3. Copy the "Client ID" and "Client Secret" of your application and paste them below.</p>
                <p>4. Remember to set "https://tube2spotify.onrender.com/callback" as a valid redirect URI.</p>
            </div>
            <form action="/export_and_transfer" method="POST" onsubmit="showLoaderSpotify()">
                <input type="text" name="youtube_api_key" class="custom-input" placeholder="Enter your YouTube API Key" required>
                <input type="text" name="playlist_id" class="custom-input" placeholder="Enter the Playlist ID" required>
                <input type="text" name="spotify_client_id" class="custom-input" placeholder="Enter your Spotify Client ID" required>
                <input type="text" name="spotify_client_secret" class="custom-input" placeholder="Enter your Spotify Client Secret" required>
                <button type="submit" class="btn btn-success">Import Playlist to Spotify</button>
            </form>

            <!-- Progress bar for Spotify transfer -->
            <div class="progress" style="height: 25px; margin-top: 20px;">
                <div id="progress-bar-spotify" class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
            </div>

            <!-- Loading message for Spotify transfer -->
            <div id="loading-message-spotify" style="text-align: center; margin-top: 20px; display: none;">
                <p>Transfer in progress, please do not close this page...</p>
            </div>
        </div>
    </div>
</div>

<!-- Minimalist style for input fields and other elements -->
<style>
    body {
        background: linear-gradient(135deg, #1c1c1c, #2c3e50);
        background-attachment: fixed;
        color: #ddd;
    }

    .custom-input {
        background-color: #222;
        color: #ddd;
        border: 1px solid #444;
        border-radius: 5px;
        padding: 10px;
        width: 100%;
        margin-bottom: 15px;
        transition: border-color 0.3s, background-color 0.3s;
    }

    .custom-input:focus {
        outline: none;
        border-color: #28a745;
        background-color: #333;
    }

    .btn-primary, .btn-success {
        width: 100%;
        margin-top: 10px;
        transition: transform 0.2s ease-in-out, background-color 0.3s ease;
    }

    .btn-primary:hover, .btn-success:hover {
        background-color: #1db954;
        transform: translateY(-2px);
    }

    .instructions {
        background-color: #222;
        padding: 10px;
        border-radius: 5px;
        margin-top: 10px;
        color: #ddd;
    }

    .instructions a {
        color: #34d058;
        text-decoration: underline;
    }

    .instructions a:hover {
        color: #76c7c0;
    }
</style>

<script>
    function showLoaderCSV() {
        document.getElementById('loading-message-csv').style.display = 'block';
        let progressBar = document.getElementById('progress-bar-csv');
        let value = 0;

        let interval = setInterval(function() {
            if (value < 100) {
                value += 1;
                progressBar.style.width = value + '%';
                progressBar.setAttribute('aria-valuenow', value);
                progressBar.innerText = value + '%';
            } else {
                clearInterval(interval);
            }
        }, 50);
    }

    function showLoaderSpotify() {
        document.getElementById('loading-message-spotify').style.display = 'block';
        let progressBar = document.getElementById('progress-bar-spotify');
        let value = 0;

        let interval = setInterval(function() {
            if (value < 100) {
                value += 1;
                progressBar.style.width = value + '%';
                progressBar.setAttribute('aria-valuenow', value);
                progressBar.innerText = value + '%';
            } else {
                clearInterval(interval);
            }
        }, 100);
    }
</script>
{% endblock %}
