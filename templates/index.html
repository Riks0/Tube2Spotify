{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h1 class="mt-5">Welcome to Tube2Spotify, {{ user_data.get('username', 'user') }}!</h1>
    <p>Ready to export your YouTube playlist to CSV or transfer it directly to Spotify?</p>

    <div class="row">
        <!-- Option to export to CSV -->
        <div class="col-md-6 mb-4">
            <h2><i class="fa fa-download"></i> Export to CSV</h2>
            <p>Get a CSV file of your YouTube playlist for easy use on other platforms.</p>
            <div class="instructions">
                <h5>How to find your YouTube API Key:</h5>
                <p>1. Go to the <a href="https://console.developers.google.com/" target="_blank">Google Developers Console</a>.</p>
                <p>2. Create a new project and enable the YouTube Data v3 API.</p>
                <p>3. Go to "Credentials" and click "Create Credentials" then "API Key".</p>
                <p>4. Copy the generated API Key and paste it below.</p>
            </div>
            <form action="/export_csv" method="POST" onsubmit="showLoaderCSV()">
                <input type="text" name="youtube_api_key" class="custom-input" placeholder="Enter your YouTube API Key" required>
                <input type="text" name="playlist_id" class="custom-input" placeholder="Enter the Playlist ID" required>
                <button type="submit" class="btn btn-primary">Export Playlist to CSV</button>
            </form>

            <!-- Progress bar for CSV export -->
            <div class="progress" style="height: 25px; margin-top: 20px;">
                <div id="progress-bar-csv" class="progress-bar progress-bar-striped progress-bar-animated bg-primary" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
            </div>

            <!-- Loading message for CSV export -->
            <div id="loading-message-csv" style="text-align: center; margin-top: 20px; display: none;">
                <p>Exporting in progress, please do not close this page...</p>
            </div>
        </div>

        <!-- Option to import directly to Spotify -->
        <div class="col-md-6 mb-4">
            <h2><i class="fa fa-spotify"></i> Import to Spotify</h2>
            <p>Transfer your YouTube playlist directly into a Spotify playlist with Tube2Spotify.</p>
            <div class="instructions">
                <h5>How to find your Spotify Credentials:</h5>
                <p>1. Go to the <a href="https://developer.spotify.com/dashboard/applications" target="_blank">Spotify Developer Dashboard</a>.</p>
                <p>2. Log in and create a new application.</p>
                <p>3. Copy the "Client ID" and "Client Secret" of your application and paste them below.</p>
                <p>4. Remember to set "http://localhost:8888/callback" as a valid redirect URI.</p>
            </div>
            <form action="/export_and_transfer" method="POST" onsubmit="showLoaderSpotify()">
                <input type="text" name="youtube_api_key" class="custom-input" placeholder="Enter your YouTube API Key" required>
                <input type="text" name="playlist_id" class="custom-input" placeholder="Enter the Playlist ID" required>
                <input type="text" name="spotify_client_id" class="custom-input" placeholder="Enter your Spotify Client ID" required>
                <input type="text" name="spotify_client_secret" class="custom-input" placeholder="Enter your Spotify Client Secret" required>
                <button type="submit" class="btn btn-success">Import Playlist to Spotify</button>
            </form>

            <!-- Progress bar for Spotify transfer -->
            <div class="progress" style="height: 25px; margin-top: 20px;">
                <div id="progress-bar-spotify" class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
            </div>

            <!-- Loading message for Spotify transfer -->
            <div id="loading-message-spotify" style="text-align: center; margin-top: 20px; display: none;">
                <p>Transfer in progress, please do not close this page...</p>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="text-center" style="background-color: #222; color: #bbb; padding: 20px; margin-top: 20px;">
    <p>Created by <a href="https://github.com/Riks0" target="_blank">Your Name</a> - Using YouTube Data and Spotify APIs.</p>
    <p>&copy; 2024 - Tube2Spotify - All Rights Reserved.</p>
    <div>
        <a href="https://github.com/Riks0" target="_blank"><i class="fa fa-github"></i></a>
        <a href="https://www.linkedin.com/in/your-profile" target="_blank"><i class="fa fa-linkedin"></i></a>
    </div>
</footer>

<!-- Minimalist style for input fields -->
<style>
    body {
        background: linear-gradient(135deg, #1c1c1c, #2c3e50);
        background-attachment: fixed;
        color: #ddd;
    }

    .custom-input {
        background-color: #222;
        color: #ddd;
        border: 1px solid #444;
        border-radius: 5px;
        padding: 10px;
        width: 100%;
        margin-bottom: 15px;
        transition: border-color 0.3s, background-color 0.3s;
    }

    .custom-input:focus {
        outline: none;
        border-color: #28a745;
        background-color: #333;
    }

    .btn-primary, .btn-success {
        width: 100%;
        margin-top: 10px;
        transition: transform 0.2s ease-in-out, background-color 0.3s ease;
    }

    .btn-primary:hover, .btn-success:hover {
        background-color: #1db954;
        transform: translateY(-2px);
    }

    .instructions {
        background-color: #222;
        padding: 10px;
        border-radius: 5px;
        margin-top: 10px;
        color: #ddd;
    }

    .instructions a {
        color: #34d058;
        text-decoration: underline;
    }

    .instructions a:hover {
        color: #76c7c0;
    }
</style>

<script>
    function showLoaderCSV() {
        document.getElementById('loading-message-csv').style.display = 'block';
        let progressBar = document.getElementById('progress-bar-csv');
        let value = 0;

        let interval = setInterval(function() {
            if (value < 100) {
                value += 1;
                progressBar.style.width = value + '%';
                progressBar.setAttribute('aria-valuenow', value);
                progressBar.innerText = value + '%';
            } else {
                clearInterval(interval);
            }
        }, 50);
    }

    function showLoaderSpotify() {
        document.getElementById('loading-message-spotify').style.display = 'block';
        let progressBar = document.getElementById('progress-bar-spotify');
        let value = 0;

        let interval = setInterval(function() {
            if (value < 100) {
                value += 1;
                progressBar.style.width = value + '%';
                progressBar.setAttribute('aria-valuenow', value);
                progressBar.innerText = value + '%';
            } else {
                clearInterval(interval);
            }
        }, 100);
    }
</script>
{% endblock %}
